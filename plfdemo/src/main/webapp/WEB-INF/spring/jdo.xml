<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
    "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
  <!-- PMF Bean -->
  <bean id="pmf"
    class="org.springframework.orm.jdo.LocalPersistenceManagerFactoryBean">
    <property name="jdoProperties">
      <props>
        <prop key="javax.jdo.PersistenceManagerFactoryClass">
          org.datanucleus.api.jdo.JDOPersistenceManagerFactory</prop>
        <prop key="javax.jdo.option.ConnectionURL">jdbc:mysql://localhost:3306/plfdemo</prop>
        <prop key="javax.jdo.option.ConnectionUserName">root</prop>
        <prop key="javax.jdo.option.ConnectionPassword">a</prop>
        <prop key="javax.jdo.option.ConnectionDriverName">com.mysql.jdbc.Driver</prop>
        <prop key="javax.jdo.option.Mapping">mysql</prop>
        <prop key="datanucleus.autoCreateSchema">true</prop>
        <prop key="datanucleus.validateTables">false</prop>
        <prop key="datanucleus.validateConstraints">false</prop>
        <prop key="datanucleus.identifier.case">PreserveCase</prop>
      </props>
    </property>
  </bean>

  <!-- Transaction Manager for PMF -->
  <!-- bean id="jdoTransactionManager" class="org.springframework.orm.jdo.JdoTransactionManager">
    <property name="persistenceManagerFactory">
      <ref local="pmf" />
    </property>
  </bean-->

  <!-- Typical DAO -->
  <bean id="dataStorage" class="khiem.dataprj.demo.plfdemo.datastore.JdoDataStorage">
    <property name="persistenceManagerFactory">
      <ref local="pmf" />
    </property>
  </bean>

  <!-- Typical Business Service --> 
  <bean id="datastoreService" class="khiem.dataprj.demo.plfdemo.service.DatastoreServiceImpl">
    <property name="dataStorage">
      <ref local="dataStorage" />
    </property>
  </bean>

  <!-- Transaction Interceptor for Business Services -->
  <!-- bean id="transactionInterceptor"
    class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
    <property name="transactionManager">
      <ref local="jdoTransactionManager" />
    </property>
    <property name="target">
      <ref local="datastoreService" />
    </property>
    <property name="transactionAttributes">
      <props>
        <prop key="store*">PROPAGATION_REQUIRED</prop>
        <prop key="delete*">PROPAGATION_REQUIRED</prop>
        <prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
      </props>
    </property>
  </bean-->
</beans>